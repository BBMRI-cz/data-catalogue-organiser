apiVersion: batch/v1
kind: CronJob
metadata:
  name: organise-sequencing
  namespace: bbmri-mou-ns
spec:
  concurrencyPolicy: Allow
  failedJobsHistoryLimit: 1
  jobTemplate:
    metadata:
      creationTimestamp: null
      namespace: bbmri-mou-ns
    spec:
      template:
        metadata:
          creationTimestamp: null
        spec:
          containers:
          - command:
            - python
            - main.py
            - -r
            - /muni-sc/PSEUDONYMIZED
            - -o
            - /muni-sc/OrganisedRuns/
            - -p
            - /muni-sc/Patients/
            image: m16f/data-catalogue-organiser:1.6.0
            imagePullPolicy: Always
            name: organise-sequencing
            securityContext:
              allowPrivilegeEscalation: false
              capabilities:
                drop:
                - ALL
            terminationMessagePath: /dev/termination-log
            terminationMessagePolicy: File
            volumeMounts:
            - mountPath: /muni-sc/
              name: storage-catalogue-volume
          dnsPolicy: ClusterFirst
          restartPolicy: Never
          schedulerName: default-scheduler
          securityContext:
            fsGroup: 1000
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1000
            runAsNonRoot: true
            runAsUser: 1005
            seccompProfile:
              type: RuntimeDefault
          terminationGracePeriodSeconds: 30
          volumes:
          - name: storage-catalogue-volume
            persistentVolumeClaim:
              claimName: mou-mmci-sequencing
  schedule: 0 22 * * 2,4,6
  successfulJobsHistoryLimit: 3
  suspend: false
